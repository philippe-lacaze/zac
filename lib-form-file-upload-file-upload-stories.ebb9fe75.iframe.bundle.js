(self.webpackChunkzac_ng_lib=self.webpackChunkzac_ng_lib||[]).push([[759],{"./projects/zac-ng-lib/src/lib/form/file-upload/file-upload.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".zac-text-color\\:secondary-500 {\n  color: var(--zac-color-secondary-500);\n}\n\n.zac-file-upload {\n  display: block;\n  width: 100%;\n}\n.zac-file-upload .dropzone {\n  border: 2px dashed #cbd5e0;\n  border-radius: 16px;\n  padding: 2rem;\n  text-align: center;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  background-color: var(--dt-color-secondary-100);\n}\n.zac-file-upload .dropzone:hover:not(.disabled):not(.readonly) {\n  border-color: #4299e1;\n  background-color: #ebf8ff;\n}\n.zac-file-upload .dropzone.drag-over {\n  border-color: #4299e1;\n  background-color: #ebf8ff;\n  transform: scale(1.02);\n}\n.zac-file-upload .dropzone.disabled, .zac-file-upload .dropzone.readonly {\n  cursor: not-allowed;\n  opacity: 0.6;\n  background-color: #edf2f7;\n}\n.zac-file-upload .dropzone-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 1rem;\n}\n.zac-file-upload .upload-icon {\n  width: 48px;\n  height: 48px;\n  color: #4299e1;\n}\n.zac-file-upload .browse-button:disabled {\n  cursor: not-allowed;\n  opacity: 0.5;\n}\n.zac-file-upload .file-types,\n.zac-file-upload .max-size {\n  margin: 0;\n  font-size: 0.75rem;\n  color: #718096;\n}\n.zac-file-upload .file-input {\n  display: none;\n}\n.zac-file-upload .uploaded-files {\n  margin-top: 1.5rem;\n}\n.zac-file-upload .uploaded-files-title {\n  margin: 0 0 1rem 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: #2d3748;\n}\n.zac-file-upload .file-list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n.zac-file-upload .file-item {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  padding: 0.75rem;\n  background-color: var(--dt-color-neutral);\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  transition: all 0.2s;\n  width: 100%;\n}\n.zac-file-upload .file-item:hover {\n  background-color: #edf2f7;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n}\n.zac-file-upload .file-preview {\n  flex-shrink: 0;\n  width: 60px;\n  height: 60px;\n  border-radius: 4px;\n  overflow: hidden;\n  background-color: #e2e8f0;\n}\n.zac-file-upload .file-preview img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n.zac-file-upload .file-icon {\n  flex-shrink: 0;\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #e2e8f0;\n  border-radius: 4px;\n}\n.zac-file-upload .file-icon svg {\n  width: 24px;\n  height: 24px;\n  color: #4a5568;\n}\n.zac-file-upload .file-info {\n  flex: 1;\n  min-width: 0;\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n.zac-file-upload .file-name {\n  font-size: 0.875rem;\n  font-weight: 500;\n  color: #2d3748;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.zac-file-upload .file-size {\n  font-size: 0.75rem;\n  color: #718096;\n}\n.zac-file-upload .file-error {\n  font-size: 0.75rem;\n  color: #e53e3e;\n}\n.zac-file-upload .remove-button {\n  flex-shrink: 0;\n  width: 32px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: transparent;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  transition: all 0.2s;\n  color: #718096;\n}\n.zac-file-upload .remove-button svg {\n  width: 18px;\n  height: 18px;\n}\n.zac-file-upload .remove-button:hover {\n  background-color: #fed7d7;\n  color: #e53e3e;\n}\n.zac-file-upload.disabled .dropzone, .zac-file-upload.readonly .dropzone {\n  cursor: not-allowed;\n}\n.zac-file-upload.disabled .browse-button, .zac-file-upload.readonly .browse-button {\n  cursor: not-allowed;\n}\n\n@media (max-width: 640px) {\n  .zac-file-upload .dropzone {\n    padding: 1.5rem 1rem;\n  }\n  .zac-file-upload .upload-icon {\n    width: 36px;\n    height: 36px;\n  }\n  .zac-file-upload .file-preview {\n    width: 48px;\n    height: 48px;\n  }\n  .zac-file-upload .file-item {\n    gap: 0.75rem;\n  }\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./projects/zac-ng-lib/src/lib/form/file-upload/file-upload.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{WithServerUpload:()=>WithServerUpload,__namedExportsOrder:()=>__namedExportsOrder,default:()=>file_upload_stories});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),dist=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs");var file_upload_componentngResource=__webpack_require__("./projects/zac-ng-lib/src/lib/form/file-upload/file-upload.component.scss?ngResource"),file_upload_componentngResource_default=__webpack_require__.n(file_upload_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),boolean_property_DaaVhX5A=__webpack_require__("./node_modules/@angular/cdk/fesm2022/boolean-property-DaaVhX5A.mjs"),value_accessor_base=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/widget/value-accessor-base.ts"),Subject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js"),common_module_Dx7dWex5=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module-Dx7dWex5.mjs"),module_z3bvLlVg=__webpack_require__("./node_modules/@angular/common/fesm2022/module-z3bvLlVg.mjs"),throwError=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/throwError.js"),Observable=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Observable.js"),tap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/tap.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),filter=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),catchError=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/catchError.js");let FileUploadService=class FileUploadService{http;progressSubject=new Subject.B;progress$=this.progressSubject.asObservable();constructor(http){this.http=http}uploadFile(file,config){const formData=this.createFormData(file,config),headers=config.headers?new module_z3bvLlVg.Lr(config.headers):void 0;return file.status="uploading",file.progress=0,this.http.request(config.method||"POST",config.url,{body:formData,headers,reportProgress:!0,observe:"events"}).pipe((0,tap.M)((event=>{if(event.type===module_z3bvLlVg.hv.UploadProgress&&event.total){const percentage=Math.round(100*event.loaded/event.total);file.progress=percentage,this.progressSubject.next({file,percentage,loaded:event.loaded,total:event.total})}})),(0,map.T)((event=>event.type===module_z3bvLlVg.hv.Response?(file.status="success",file.progress=100,{file,response:event.body,success:!0}):null)),(0,filter.p)((result=>null!==result)),(0,catchError.W)((error=>(file.status="error",file.error=this.getErrorMessage(error),(0,throwError.$)((()=>({file,error,success:!1})))))))}uploadFiles(files,config){return new Observable.c((observer=>{const results=[];let currentIndex=0;const uploadNext=()=>{if(currentIndex>=files.length)return observer.next(results),void observer.complete();const file=files[currentIndex];currentIndex++,this.uploadFile(file,config).subscribe({next:result=>{results.push(result),uploadNext()},error:errorResult=>{results.push(errorResult),uploadNext()}})};uploadNext()}))}uploadFilesParallel(files,config,maxConcurrent=3){return new Observable.c((observer=>{const results=new Array(files.length);let completed=0,started=0;const uploadNext=()=>{for(;started<files.length&&started-completed<maxConcurrent;){const index=started,file=files[index];started++,this.uploadFile(file,config).subscribe({next:result=>{results[index]=result,completed++,completed===files.length?(observer.next(results),observer.complete()):uploadNext()},error:errorResult=>{results[index]=errorResult,completed++,completed===files.length?(observer.next(results),observer.complete()):uploadNext()}})}};uploadNext()}))}uploadFilesInBatch(files,config){const formData=new FormData,fieldName=config.fieldName||"files";files.forEach(((uploadedFile,index)=>{formData.append(`${fieldName}[${index}]`,uploadedFile.file,uploadedFile.name),uploadedFile.status="uploading",uploadedFile.progress=0})),config.additionalData&&Object.keys(config.additionalData).forEach((key=>{formData.append(key,config.additionalData[key])}));const headers=config.headers?new module_z3bvLlVg.Lr(config.headers):void 0;return this.http.request(config.method||"POST",config.url,{body:formData,headers,reportProgress:!0,observe:"events"}).pipe((0,tap.M)((event=>{if(event.type===module_z3bvLlVg.hv.UploadProgress&&event.total){const percentage=Math.round(100*event.loaded/event.total);files.forEach((file=>{file.progress=percentage}))}})),(0,map.T)((event=>event.type===module_z3bvLlVg.hv.Response?(files.forEach((file=>{file.status="success",file.progress=100})),{file:files[0],response:event.body,success:!0}):null)),(0,map.T)((result=>result)),(0,catchError.W)((error=>(files.forEach((file=>{file.status="error",file.error=this.getErrorMessage(error)})),(0,throwError.$)((()=>({file:files[0],error,success:!1})))))))}createFormData(file,config){const formData=new FormData,fieldName=config.fieldName||"file";return formData.append(fieldName,file.file,file.name),config.additionalData&&Object.keys(config.additionalData).forEach((key=>{formData.append(key,config.additionalData[key])})),formData}getErrorMessage(error){return error.error instanceof ErrorEvent?error.error.message:error.error?.message||error.message||`Erreur ${error.status}`}cancelAllUploads(){console.warn("Cancel all uploads not implemented yet")}static ctorParameters=()=>[{type:module_z3bvLlVg.Qq}]};FileUploadService=(0,tslib_es6.Cg)([(0,core.Injectable)({providedIn:"root"})],FileUploadService);var angular_fontawesome=__webpack_require__("./node_modules/@fortawesome/angular-fontawesome/fesm2020/angular-fontawesome.mjs"),free_solid_svg_icons=__webpack_require__("./node_modules/@fortawesome/free-solid-svg-icons/index.mjs"),button_component=__webpack_require__("./projects/zac-ng-lib/src/lib/button/button.component.ts");let FileUploadComponent=class FileUploadComponent extends value_accessor_base.k{fileInput;controlPanel=!0;isUploading;errorMessage;uploadResults;fileUploadService=(0,core.inject)(FileUploadService);set multiple(value){this._multiple=(0,boolean_property_DaaVhX5A.c)(value)}get multiple(){return this._multiple}_multiple=!1;accept;maxSize;maxFiles;set showPreview(value){this._showPreview=(0,boolean_property_DaaVhX5A.c)(value)}get showPreview(){return this._showPreview}_showPreview=!0;dropzoneText="Glissez ici les fichiers ou cliquez sur le bouton pour les sélectionner.";browseButtonText="Parcourir mes dossiers...";hintText;filesSelected=new core.EventEmitter;fileRemoved=new core.EventEmitter;validationError=new core.EventEmitter;uploadedFiles=[];isDragOver=!1;destroy$=new Subject.B;disabled=!1;constructor(injector,elementRef){super(injector,elementRef)}ngOnInit(){super.ngOnInit()}ngOnChanges(changes){this.hintText||(this.hintText=this.buildHintText())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.revokePreviewUrls()}onDropzoneClick(){this.$isReadonlyState()||this.fileInput?.nativeElement.click()}onFileInputChange(event){const input=event.target;input.files&&input.files.length>0&&(this.handleFiles(Array.from(input.files)),input.value="")}onDragOver(event){this.$isReadonlyState()||(event.preventDefault(),event.stopPropagation(),this.isDragOver=!0,this.cdr.markForCheck())}onDragLeave(event){event.preventDefault(),event.stopPropagation(),this.isDragOver=!1,this.cdr.markForCheck()}onDrop(event){if(this.$isReadonlyState())return;event.preventDefault(),event.stopPropagation(),this.isDragOver=!1;const files=event.dataTransfer?.files;files&&files.length>0&&this.handleFiles(Array.from(files)),this.cdr.markForCheck()}handleFiles(files){const validFiles=[],errors=[];if(this.maxFiles&&this.uploadedFiles.length+files.length>this.maxFiles){const error=`Nombre maximum de fichiers dépassé (${this.maxFiles} maximum)`;errors.push(error),this.validationError.emit(error)}for(const file of files){if(this.maxSize&&file.size>this.maxSize){const error=`Le fichier "${file.name}" dépasse la taille maximale (${this.formatFileSize(this.maxSize)})`;errors.push(error);continue}if(this.accept&&!this.isFileTypeAccepted(file)){const error=`Le type du fichier "${file.name}" n'est pas accepté`;errors.push(error);continue}const uploadedFile={file,name:file.name,size:file.size,type:file.type,status:"success"};this.showPreview&&file.type.startsWith("image/")&&(uploadedFile.preview=URL.createObjectURL(file)),validFiles.push(uploadedFile)}errors.length>0&&this.validationError.emit(errors.join("\n")),validFiles.length>0&&(this.multiple?this.uploadedFiles=[...this.uploadedFiles,...validFiles]:(this.revokePreviewUrls(),this.uploadedFiles=[validFiles[0]]),this.updateValue(),this.filesSelected.emit(validFiles),this.cdr.markForCheck())}removeFile(file){this.$isReadonlyState()||(file.preview&&URL.revokeObjectURL(file.preview),this.uploadedFiles=this.uploadedFiles.filter((f=>f!==file)),this.updateValue(),this.fileRemoved.emit(file),this.cdr.markForCheck())}updateValue(){const files=this.uploadedFiles;this.multiple?this.innerValue=files.length>0?files:null:this.innerValue=files.length>0?files[0]:null}isFileTypeAccepted(file){if(!this.accept)return!0;const acceptedTypes=this.accept.split(",").map((t=>t.trim()));for(const acceptedType of acceptedTypes)if(acceptedType.endsWith("/*")){const category=acceptedType.split("/")[0];if(file.type.startsWith(category+"/"))return!0}else if(acceptedType.startsWith(".")){if(file.name.toLowerCase().endsWith(acceptedType.toLowerCase()))return!0}else if(file.type===acceptedType)return!0;return!1}formatFileSize(bytes){if(0===bytes)return"";const i=Math.floor(Math.log(bytes)/Math.log(1e3));return Math.round(bytes/Math.pow(1e3,i)*100)/100+" "+["Octets","Ko (kilo-octets)","Mo (mégaoctets)","Go (gigaoctets)"][i]}revokePreviewUrls(){this.uploadedFiles.forEach((file=>{file.preview&&URL.revokeObjectURL(file.preview)}))}validate(){return this.uploadedFiles&&0!==this.uploadedFiles.length?null:{required:!0}}writeValue(value){if(super.writeValue(value),value){const files=Array.isArray(value)?value:[value];this.uploadedFiles=[...files]}else this.revokePreviewUrls(),this.uploadedFiles=[];this.cdr.markForCheck()}determineIfRoleGroup(){return!1}uploadToServer(){const files=this.uploadedFiles;files&&0!==files.length?(console.log("Upload vers le serveur..."),this.isUploading=!0,this.errorMessage="",this.uploadResults=[],this.fileUploadService.uploadFiles(files,{url:"api/upload",fieldName:"file",additionalData:{description:"Upload depuis Storybook"}}).subscribe({next:results=>{this.isUploading=!1,this.uploadResults=results,console.log("Upload terminé avec succès:",results),this.cdr.detectChanges()},error:error=>{this.isUploading=!1,this.errorMessage="Erreur lors de l'upload: "+(error.message||"Erreur inconnue"),console.error("Erreur d'upload:",error),this.cdr.detectChanges()}})):console.warn("Aucun fichier à uploader")}faArrowUpFromBracket=free_solid_svg_icons.MNJ;buildHintText(){let text="";if(this.multiple&&(this.maxFiles??0)>1?text+=`1 à ${this.maxFiles} fichiers`:text+="1 fichier",this.maxSize&&(text+=` d'une taille maximale de ${this.formatFileSize(this.maxSize)}`),this.accept){const pluriel=this.accept.split(",").length>1?"s":"";text+=` au${pluriel?"x":""} format${pluriel?"s":""} ${this.accept}`}return text}static ctorParameters=()=>[{type:core.Injector},{type:core.ElementRef}];static propDecorators={fileInput:[{type:core.ViewChild,args:["fileInput"]}],controlPanel:[{type:core.Input}],multiple:[{type:core.Input}],accept:[{type:core.Input}],maxSize:[{type:core.Input}],maxFiles:[{type:core.Input}],showPreview:[{type:core.Input,args:[{transform:core.booleanAttribute}]}],dropzoneText:[{type:core.Input}],browseButtonText:[{type:core.Input}],hintText:[{type:core.Input}],filesSelected:[{type:core.Output}],fileRemoved:[{type:core.Output}],validationError:[{type:core.Output}],onDragOver:[{type:core.HostListener,args:["dragover",["$event"]]}],onDragLeave:[{type:core.HostListener,args:["dragleave",["$event"]]}],onDrop:[{type:core.HostListener,args:["drop",["$event"]]}]}};FileUploadComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"zac-file-upload",template:'<div class="zac-file-upload" [class.disabled]="disabled" [class.readonly]="$isReadonlyState()">\n\n  \x3c!-- Zone de dépôt --\x3e\n  <div\n    class="dropzone"\n    [class.drag-over]="isDragOver"\n    [class.has-files]="uploadedFiles.length > 0"\n    (click)="onDropzoneClick()"\n    [attr.aria-label]="dropzoneText">\n\n    <div class="dropzone-content">\n      <fa-icon class="upload-icon zac-text-style:4XL zac-text-color:secondary-500"\n               [icon]="faArrowUpFromBracket"></fa-icon>\n\n      <p class="dropzone-text zac-text-style:S-semibold">{{ dropzoneText }}</p>\n\n      <button\n        type="button"\n        class="browse-button zac-button--secondary"\n        [disabled]="disabled || $isReadonlyState()"\n        (click)="$event.stopPropagation(); onDropzoneClick()">\n        {{ browseButtonText }}\n      </button>\n\n      @if (hintText) {\n        <p class="dropzone-text zac-text-style:S">{{ hintText }}</p>\n      }\n    </div>\n  </div>\n\n  \x3c!-- Input file caché --\x3e\n  <input\n    #fileInput\n    type="file"\n    class="file-input"\n    [multiple]="multiple"\n    [accept]="accept"\n    [disabled]="disabled || $isReadonlyState()"\n    (change)="onFileInputChange($event)"\n    aria-hidden="true"\n    tabindex="-1">\n\n  \x3c!-- Liste des fichiers uploadés --\x3e\n  @if (uploadedFiles.length > 0) {\n    <div class="uploaded-files">\n      <h4 class="uploaded-files-title">\n        Fichiers sélectionnés ({{ uploadedFiles.length }})\n      </h4>\n\n      <ul class="file-list">\n        @for (file of uploadedFiles; track file.name) {\n          <li class="file-item" [class.has-preview]="file.preview">\n\n            \x3c!-- Prévisualisation pour les images --\x3e\n            @if (file.preview && showPreview) {\n              <div class="file-preview">\n                <img [src]="file.preview" [alt]="file.name">\n              </div>\n            }\n\n            \x3c!-- Icône pour les fichiers non-image --\x3e\n            @if (!file.preview) {\n              <div class="file-icon">\n                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"\n                     stroke-width="2">\n                  <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>\n                  <polyline points="13 2 13 9 20 9"></polyline>\n                </svg>\n              </div>\n            }\n\n            \x3c!-- Informations du fichier --\x3e\n            <div class="file-info">\n              <span class="file-name" [title]="file.name">{{ file.name }}</span>\n              <span class="file-size">{{ formatFileSize(file.size) }}</span>\n\n              @if (file.status === \'error\' && file.error) {\n                <span class="file-error">{{ file.error }}</span>\n              }\n            </div>\n\n            \x3c!-- Bouton de suppression --\x3e\n            @if (!disabled && !$isReadonlyState()) {\n              <zac-button\n                name="Abandonner"\n                label="Supprimer"\n                (click)="removeFile(file)"\n                [attr.aria-label]="\'Supprimer \' + file.name">\n              </zac-button>\n            }\n          </li>\n        }\n      </ul>\n    </div>\n  } @else {\n    <div class="uploaded-files">\n      <p class="zac-text-style:S">Aucun fichier sélectionné</p>\n    </div>\n  }\n</div>\n<ng-container *ngIf="controlPanel">\n\n  @if (uploadedFiles && uploadedFiles.length > 0) {\n    <div style="margin-top: 1rem;">\n      <button\n        type="button"\n        (click)="uploadToServer()"\n        [disabled]="isUploading"\n        style="padding: 0.5rem 1rem; background-color: #4299e1; color: white; border: none; border-radius: 4px; cursor: pointer;"\n      >\n        {{\n          isUploading ? \'Upload en cours...\' : \'Uploader vers le serveur\'\n        }}\n      </button>\n    </div>\n  }\n\n  @if (errorMessage) {\n    <div\n      style="margin-top: 1rem; padding: 0.75rem; background-color: #fed7d7; border-radius: 4px; color: #c53030;"\n    >\n      <strong>✗ Erreur:</strong> {{ errorMessage }}\n    </div>\n  }\n\n  @if (uploadResults?.length ?? 0 > 0) {\n    <div\n      style="margin-top: 1rem; padding: 0.75rem; background-color: #c6f6d5; border-radius: 4px; color: #22543d;"\n    >\n      <strong>✓ Upload réussi!</strong>\n      <div style="margin-top: 0.5rem; font-size: 0.875rem;">\n        {{ uploadResults?.length }} fichier(s) uploadé(s)\n      </div>\n    </div>\n  }\n\n</ng-container>\n',encapsulation:core.ViewEncapsulation.None,changeDetection:core.ChangeDetectionStrategy.OnPush,standalone:!0,imports:[common_module_Dx7dWex5.bT,angular_fontawesome.dX,button_component.Q],providers:[{provide:fesm2022_forms.kq,useExisting:FileUploadComponent,multi:!0},{provide:fesm2022_forms.cz,useExisting:FileUploadComponent,multi:!0}],styles:[file_upload_componentngResource_default()]})],FileUploadComponent);var form_field_component=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-field/form-field.component.ts"),errors_directive=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-error/errors/errors.directive.ts");let UploadWrapperComponent=class UploadWrapperComponent{model={fichiers:void 0};multiple=!0;disabled=!1;readonly=!1;maxSize=0;maxFiles=0;accept="";hintText;showPreview;uploadResults=[];isUploading=!1;errorMessage="";fileUploadService=(0,core.inject)(FileUploadService);onFilesSelected(files){console.log("Fichiers sélectionnés:",files)}uploadToServer(){const files=this.model.fichiers;files&&0!==files.length?(console.log("Upload vers le serveur..."),this.isUploading=!0,this.errorMessage="",this.uploadResults=[],this.fileUploadService.uploadFiles(files,{url:"api/upload",fieldName:"file",additionalData:{description:"Upload depuis Storybook"}}).subscribe({next:results=>{this.isUploading=!1,this.uploadResults=results,console.log("Upload terminé avec succès:",results)},error:error=>{this.isUploading=!1,this.errorMessage="Erreur lors de l'upload: "+(error.message||"Erreur inconnue"),console.error("Erreur d'upload:",error)}})):console.warn("Aucun fichier à uploader")}static propDecorators={model:[{type:core.Input}],multiple:[{type:core.Input}],disabled:[{type:core.Input}],readonly:[{type:core.Input}],maxSize:[{type:core.Input}],maxFiles:[{type:core.Input}],accept:[{type:core.Input}],hintText:[{type:core.Input}],showPreview:[{type:core.Input}]}};UploadWrapperComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"app-upload-wrapper",standalone:!0,imports:[fesm2022_forms.YN,FileUploadComponent,form_field_component.K,common_module_Dx7dWex5.MD],template:'\n    <div>\n      <zac-form-field label="Sélectionner des fichiers à envoyer">\n        <zac-file-upload\n          [(ngModel)]="model.fichiers"\n          [multiple]="multiple"\n          [maxFiles]="maxFiles"\n          [maxSize]="maxSize"\n          [accept]="accept"\n          [disabled]="disabled || isUploading"\n          [hintText]="hintText"\n          [showPreview]="showPreview"\n          (filesSelected)="onFilesSelected($event)"\n        >\n        </zac-file-upload>\n      </zac-form-field>\n\n      \x3c!--      @if (model.fichiers && model.fichiers.length > 0) {--\x3e\n      \x3c!--        <div style="margin-top: 1rem;">--\x3e\n      \x3c!--          <button--\x3e\n      \x3c!--            type="button"--\x3e\n      \x3c!--            (click)="uploadToServer()"--\x3e\n      \x3c!--            [disabled]="isUploading"--\x3e\n      \x3c!--            style="padding: 0.5rem 1rem; background-color: #4299e1; color: white; border: none; border-radius: 4px; cursor: pointer;"--\x3e\n      \x3c!--          >--\x3e\n      \x3c!--            {{--\x3e\n      \x3c!--              isUploading ? \'Upload en cours...\' : \'Uploader vers le serveur\'--\x3e\n      \x3c!--            }}--\x3e\n      \x3c!--          </button>--\x3e\n      \x3c!--        </div>--\x3e\n      \x3c!--      }--\x3e\n\n      \x3c!--      @if (errorMessage) {--\x3e\n      \x3c!--        <div--\x3e\n      \x3c!--          style="margin-top: 1rem; padding: 0.75rem; background-color: #fed7d7; border-radius: 4px; color: #c53030;"--\x3e\n      \x3c!--        >--\x3e\n      \x3c!--          <strong>✗ Erreur:</strong> {{ errorMessage }}--\x3e\n      \x3c!--        </div>--\x3e\n      \x3c!--      }--\x3e\n\n      \x3c!--      @if (uploadResults.length > 0) {--\x3e\n      \x3c!--        <div--\x3e\n      \x3c!--          style="margin-top: 1rem; padding: 0.75rem; background-color: #c6f6d5; border-radius: 4px; color: #22543d;"--\x3e\n      \x3c!--        >--\x3e\n      \x3c!--          <strong>✓ Upload réussi!</strong>--\x3e\n      \x3c!--          <div style="margin-top: 0.5rem; font-size: 0.875rem;">--\x3e\n      \x3c!--            {{ uploadResults.length }} fichier(s) uploadé(s)--\x3e\n      \x3c!--          </div>--\x3e\n      \x3c!--        </div>--\x3e\n      \x3c!--      }--\x3e\n    </div>\n  '})],UploadWrapperComponent);const file_upload_stories={title:"Formulaire/FileUpload",component:FileUploadComponent,tags:["docs"],decorators:[(0,dist.moduleMetadata)({imports:[fesm2022_forms.YN,fesm2022_forms.X1,FileUploadComponent,form_field_component.K,errors_directive.R,UploadWrapperComponent],providers:[FileUploadService]})],argTypes:{model:{control:"object",table:{disable:!0}},multiple:{control:"boolean",description:"Permet la sélection de plusieurs fichiers"},accept:{control:"text",description:"Types de fichiers acceptés (ex: .pdf,.jpg,.png ou image/*)"},maxSize:{control:"number",description:"Taille maximale d'un fichier en octets"},maxFiles:{control:"number",description:"Nombre maximum de fichiers autorisés"},showPreview:{control:"boolean",description:"Afficher les prévisualisations pour les images"},disabled:{control:"boolean"},readonly:{control:"boolean"},dropzoneText:{control:"text",description:"Texte personnalisé pour la zone de dépôt"},browseButtonText:{control:"text",description:"Texte du bouton de sélection"}}},WithServerUpload={args:{model:{fichiers:void 0},multiple:!0,disabled:!1,readonly:!1},render:args=>({props:args,template:'<app-upload-wrapper\n        [model]="model"\n        [multiple]="multiple"\n        [maxSize]="maxSize"\n        [maxFiles]="maxFiles"\n        [disabled]="disabled"\n        [accept]="accept"\n        [readonly]="readonly"\n        [hintText]="hintText"\n        [showPreview]="showPreview"\n        >\n</app-upload-wrapper>'})},__namedExportsOrder=["WithServerUpload"];WithServerUpload.parameters={...WithServerUpload.parameters,docs:{...WithServerUpload.parameters?.docs,source:{originalSource:'{\n  args: {\n    model: {\n      fichiers: undefined\n    },\n    multiple: true,\n    disabled: false,\n    readonly: false\n  },\n  render: args => ({\n    props: args,\n    template: `<app-upload-wrapper\n        [model]="model"\n        [multiple]="multiple"\n        [maxSize]="maxSize"\n        [maxFiles]="maxFiles"\n        [disabled]="disabled"\n        [accept]="accept"\n        [readonly]="readonly"\n        [hintText]="hintText"\n        [showPreview]="showPreview"\n        >\n</app-upload-wrapper>`\n  })\n}',...WithServerUpload.parameters?.docs?.source},description:{story:"Exemple d'upload vers un serveur avec le FileUploadService",...WithServerUpload.parameters?.docs?.description}}}},"./projects/zac-ng-lib/src/lib/form/form-field/form-field.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{K:()=>FormFieldComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var form_field_componentngResource=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-field/form-field.component.scss?ngResource"),form_field_componentngResource_default=__webpack_require__.n(form_field_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),zac_label_component=__webpack_require__("./projects/zac-ng-lib/src/lib/form/zac-label/zac-label.component.ts"),errors_directive=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-error/errors/errors.directive.ts"),common_module_Dx7dWex5=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module-Dx7dWex5.mjs"),error_component=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-error/error/error.component.ts"),form_field=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-field/form-field.ts"),zac_label_for_input_service=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/service/zac-label-for-input.service.ts"),platform_browser=__webpack_require__("./node_modules/@angular/platform-browser/fesm2022/platform-browser.mjs");let AbstractSanitizerPipe=class AbstractSanitizerPipe{domSanitizer;constructor(domSanitizer){this.domSanitizer=domSanitizer}static ctorParameters=()=>[{type:platform_browser.DomSanitizer}]};AbstractSanitizerPipe=(0,tslib_es6.Cg)([(0,core.Injectable)()],AbstractSanitizerPipe);let SafeHtmlPipe=class SafeHtmlPipe extends AbstractSanitizerPipe{transform(html){return this.domSanitizer.bypassSecurityTrustHtml(html)}};SafeHtmlPipe=(0,tslib_es6.Cg)([(0,core.Pipe)({name:"safeHtml",standalone:!0})],SafeHtmlPipe);let SafeStylePipe=class SafeStylePipe extends AbstractSanitizerPipe{transform(style){return this.domSanitizer.bypassSecurityTrustStyle(style)}};SafeStylePipe=(0,tslib_es6.Cg)([(0,core.Pipe)({name:"safeStyle",standalone:!0})],SafeStylePipe);let SafeScriptPipe=class SafeScriptPipe extends AbstractSanitizerPipe{transform(script){return this.domSanitizer.bypassSecurityTrustScript(script)}};SafeScriptPipe=(0,tslib_es6.Cg)([(0,core.Pipe)({name:"safeScript",standalone:!0})],SafeScriptPipe);let SafeUrlPipe=class SafeUrlPipe extends AbstractSanitizerPipe{transform(url){return this.domSanitizer.bypassSecurityTrustUrl(url)}};SafeUrlPipe=(0,tslib_es6.Cg)([(0,core.Pipe)({name:"safeUrl",standalone:!0})],SafeUrlPipe);let SafeResourceUrlPipe=class SafeResourceUrlPipe extends AbstractSanitizerPipe{transform(resourceUrl){return this.domSanitizer.bypassSecurityTrustResourceUrl(resourceUrl)}};SafeResourceUrlPipe=(0,tslib_es6.Cg)([(0,core.Pipe)({name:"safeResourceUrl",standalone:!0})],SafeResourceUrlPipe);var abstract_form_field_component=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-field/abstract-form-field.component.ts");let FormFieldComponent=class FormFieldComponent extends abstract_form_field_component.W{set label(value){this._stringLabel=value}errorPosition="under";set hint(value){this._hint=value}get hint(){return this._hint}hintPosition="under";constructor(elementRef,render,labelForInputService,errorsDirective){super(elementRef,render,labelForInputService,errorsDirective)}static ctorParameters=()=>[{type:core.ElementRef},{type:core.Renderer2},{type:zac_label_for_input_service.$},{type:errors_directive.R,decorators:[{type:core.Optional}]}];static propDecorators={label:[{type:core.Input}],errorPosition:[{type:core.Input}],hint:[{type:core.Input}],hintPosition:[{type:core.Input}]}};FormFieldComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"zac-form-field",template:'<ng-container\n  *ngIf="projectedNgControl && $readOnlyStateApplied() !== undefined"\n>\n  @let isRoleGroup = false;\n  <ng-container *ngIf="!isRoleGroup">\n    \x3c!-- On est ici dans un zac qui ne contient qu\'un seul élément de form html --\x3e\n    \x3c!-- On utilise un zac-label mais seulement si on ne l\'a pas projeté --\x3e\n\n    <ng-container *ngTemplateOutlet="zacLabelTemplate" />\n\n    <div\n      id="{{ ngControlElement?.id }}-hint"\n      class="{{ hintClasses }}"\n      *ngIf="!$readonly() && hint && \'above\' === hintPosition"\n    >\n      {{ hint }}\n    </div>\n\n    <ng-container *ngIf="\'above\' === errorPosition">\n      <ng-container *ngTemplateOutlet="errorTemplate"></ng-container>\n    </ng-container>\n\n    <ng-container *ngTemplateOutlet="formElementTemplate"></ng-container>\n\n    <div\n      id="{{ ngControlElement?.id }}-hint"\n      class="{{ hintClasses }}"\n      *ngIf="!$readonly() && hint && \'under\' === hintPosition"\n    >\n      {{ hint }}\n    </div>\n\n    <ng-container *ngIf="\'under\' === errorPosition">\n      <ng-container *ngTemplateOutlet="errorTemplate"></ng-container>\n    </ng-container>\n  </ng-container>\n\n  \x3c!-- ce code est une possibilité qui n\'est plus activé mais est gardé pour référence --\x3e\n  <ng-container *ngIf="isRoleGroup" #zacRoleGroupTemplate>\n    \x3c!-- On est ici dans un zac qui contient plusieurs éléments de form html --\x3e\n    \x3c!-- On va wrapper l\'élément de formulaire projeté dans un fieldset legend  --\x3e\n    \x3c!-- uniquement si on a pa projeté aussi un zac-label  --\x3e\n    <fieldset>\n      <legend *ngIf="stringLabel && !projectedLabelComponent" class="label">\n        {{ stringLabel }}\n        <ng-container *ngTemplateOutlet="requiredOrOptionalTemplate"/>\n      </legend>\n      <legend *ngIf="projectedLabelComponent" class="label">\n        <ng-container *ngTemplateOutlet="zacLabelTemplate" />\n      </legend>\n\n      <div\n        id="{{ ngControlElement?.id }}-hint"\n        class="{{ hintClasses }}"\n        *ngIf="!$readonly() && hint && \'above\' === hintPosition"\n      >\n        {{ hint }}\n      </div>\n\n      <ng-container *ngIf="\'above\' === errorPosition">\n        <ng-container *ngTemplateOutlet="errorTemplate"></ng-container>\n      </ng-container>\n\n      <ng-container *ngTemplateOutlet="formElementTemplate"></ng-container>\n\n      <div\n        id="{{ ngControlElement?.id }}-hint"\n        class="{{ hintClasses }}"\n        *ngIf="!$readonly() && hint && \'under\' === hintPosition"\n      >\n        {{ hint }}\n      </div>\n\n      <ng-container *ngIf="\'under\' === errorPosition">\n        <ng-container *ngTemplateOutlet="errorTemplate"></ng-container>\n      </ng-container>\n\n      \x3c!--  @deprecated depuis qu\'on gère avec fieldset + legend\n      <ng-container\n        (zacAfterViewInit)="afterRoleGroupTemplateInit()"\n      ></ng-container>\n      --\x3e\n    </fieldset>\n  </ng-container>\n\n  <ng-template #zacLabelTemplate>\n    <ng-container *ngIf="stringLabel && !projectedLabelComponent">\n      <zac-label #generatedZacLabel for="{{ contentControlId }}"\n        >{{ stringLabel }}\n        <ng-container *ngTemplateOutlet="requiredOrOptionalTemplate"/>\n      </zac-label>\n    </ng-container>\n\n    <ng-container *ngIf="projectedLabelComponent">\n      <ng-content select="zac-label" />\n    </ng-container>\n  </ng-template>\n\n  <ng-template #formElementTemplate>\n    \x3c!-- Ici sera projeté le FormControl contenu --\x3e\n    <ng-content select=":not(zac-label):not(zac-error)"></ng-content>\n  </ng-template>\n\n  <ng-template #errorTemplate>\n    <ng-container *ngIf="!$readonly() && errorsDirective">\n      <ng-container *ngIf="projectedErrorComponent">\n        <ng-content select="zac-error" />\n      </ng-container>\n      <ng-container *ngIf="!projectedErrorComponent">\n        <zac-error controlName="{{ projectedNgControl.name }}"></zac-error>\n      </ng-container>\n    </ng-container>\n  </ng-template>\n\n  <ng-template #requiredOrOptionalTemplate>\n    @if (\n      $requiredOrOptionalClause();\n      as roInfo\n      ) {\n      <div class="required-or-optional" [innerHTML]="roInfo | safeHtml"></div>\n    }\n  </ng-template>\n</ng-container>\n',imports:[common_module_Dx7dWex5.bT,zac_label_component.w,common_module_Dx7dWex5.T3,SafeHtmlPipe,(0,core.forwardRef)((()=>error_component.A))],providers:[{provide:form_field.k,useExisting:(0,core.forwardRef)((()=>FormFieldComponent))}],encapsulation:core.ViewEncapsulation.None,changeDetection:core.ChangeDetectionStrategy.OnPush,host:{class:"zac-form-field"},styles:[form_field_componentngResource_default()]})],FormFieldComponent)}}]);