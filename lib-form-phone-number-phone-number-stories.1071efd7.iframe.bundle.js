(self.webpackChunkzac_ng_lib=self.webpackChunkzac_ng_lib||[]).push([[633],{"./projects/zac-ng-lib/src/lib/form/phone-number/phone-number.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ExempleNominal:()=>ExempleNominal,__namedExportsOrder:()=>__namedExportsOrder,default:()=>phone_number_stories});var dist=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),focusgroup_accessor_base=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/widget/focusgroup-accessor-base.ts"),select_component=__webpack_require__("./projects/zac-ng-lib/src/lib/form/select/select.component.ts");class IndicatifTelephoniqueParPays{indicatif;nomPays;codeIso;constructor(indicatif,nomPays,codeIso){this.indicatif=indicatif,this.nomPays=nomPays,this.codeIso=codeIso}toString(){return`(+${this.indicatif}) ${this.nomPays}`}}var abstract_http_store=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/service/store/abstract-http-store.ts"),module_z3bvLlVg=__webpack_require__("./node_modules/@angular/common/fesm2022/module-z3bvLlVg.mjs");let IndicatifsTelephoniquesStoreService=class IndicatifsTelephoniquesStoreService extends abstract_http_store.O{sortedBy="";constructor(){super((0,core.inject)(module_z3bvLlVg.Qq))}url=`/gcmext/wsrest/phone-prefixes${this.sortedBy}`;dataType=Array;elementType=IndicatifTelephoniqueParPays;static ctorParameters=()=>[]};IndicatifsTelephoniquesStoreService=(0,tslib_es6.Cg)([(0,core.Injectable)()],IndicatifsTelephoniquesStoreService);var PhoneTypeEnum,tap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/tap.js"),catchError=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/catchError.js"),firstValueFrom=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/firstValueFrom.js"),load_indicatifs_telephoniques=__webpack_require__("./projects/zac-ng-lib/src/lib/form/phone-number/service/load-indicatifs-telephoniques.ts"),index_esm=__webpack_require__("./node_modules/awesome-phonenumber/index-esm.mjs"),custom_message_and_focus=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-error/custom-message-and-focus.ts");!function(PhoneTypeEnum){PhoneTypeEnum.mobile="mobile",PhoneTypeEnum.fixe="fixe",PhoneTypeEnum.fax="fax"}(PhoneTypeEnum||(PhoneTypeEnum={}));var PhoneNumberComponent_1,common_module_Dx7dWex5=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module-Dx7dWex5.mjs"),on_init_directive=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/widget/on-init.directive.ts");let PhoneNumberComponent=class PhoneNumberComponent extends focusgroup_accessor_base.I{static{PhoneNumberComponent_1=this}static _$indicatifsTelephoniquesParPaysTuple=(0,core.signal)(void 0);indicatifPropertyName=(0,core.input)("indicatif");numeroPropertyName=(0,core.input)("numero");autoFormat=(0,core.input)(!0);type=(0,core.input)(void 0);get $indicatifsTelephoniquesParPaysTuple(){return PhoneNumberComponent_1._$indicatifsTelephoniquesParPaysTuple}get $indicatifsTelephoniquesParPaysChoiceTuple(){return this.$indicatifsTelephoniquesParPaysTuple}$exempleNumero=(0,core.signal)("");formGroup=new fesm2022_forms.AG({});$readOnlyValue=(0,core.signal)("");$inputNumeroElementRef=(0,core.viewChild)("inputNumero");$selectIndicatifElementRef=(0,core.viewChild)(select_component.w);$selectId=(0,core.signal)(void 0);indicatifsTelephoniqueStoreService=(0,core.inject)(IndicatifsTelephoniquesStoreService,{optional:!0});internalPhoneNumber;constructor(injector,elementRef){super(injector,elementRef)}ngOnInit(){this.initializeListeIndicatifsTelephoniquesParPays().then(),super.ngOnInit(),setTimeout((()=>{this.isRequired()&&(this.formGroup.get(this.indicatifPropertyName())?.addValidators(fesm2022_forms.k0.required),this.formGroup.get(this.numeroPropertyName())?.addValidators(fesm2022_forms.k0.required))})),this.formGroup.addControl(this.indicatifPropertyName(),new fesm2022_forms.MJ),this.formGroup.addControl(this.numeroPropertyName(),new fesm2022_forms.MJ),this.updateExempleNumeroForCodeIso(this.internalPhoneNumber?.regionCode??"FR")}focus(){this.indicatifPropertyName()&&!this.innerValue?.[this.indicatifPropertyName()]?this.$selectIndicatifElementRef()?.nativeElement.focus():this.$inputNumeroElementRef()?.nativeElement.focus()}validate(control){const value=control.value;if(!value)return null;const phoneNumber=value[this.numeroPropertyName()],countryCallingCode=value[this.indicatifPropertyName()];return!countryCallingCode&&phoneNumber?{required:new custom_message_and_focus.K("Veuillez choisir un indicatif.")}:countryCallingCode&&!phoneNumber?{required:new custom_message_and_focus.K("Veuillez saisir un numéro.")}:phoneNumber&&countryCallingCode&&!this.parsePhoneNumberForIndicatif(phoneNumber,countryCallingCode).valid?{invalid:new custom_message_and_focus.K("Veuillez renseigner un numéro de téléphone valide.",`${this.id}-telephone`,[`${this.id}-indicatif`,`${this.id}-telephone`])}:null}onComponentFocusLost(){super.onComponentFocusLost(),this.innerValue=this.formGroup.value}writeValue(outerValue){outerValue&&this._innerValue!==outerValue?this.$indicatifsTelephoniquesParPaysTuple()?(super.writeValue(outerValue),this.$readOnlyValue.set(this.buildReadOnlyValue())):this.initializeListeIndicatifsTelephoniquesParPays().then((()=>{super.writeValue(outerValue),this.$readOnlyValue.set(this.buildReadOnlyValue()),this.cdr.detectChanges()})):super.writeValue(outerValue)}writeInnerValue(value,fireChangeValue=!0){if(super.writeInnerValue(value,fireChangeValue),this.numeroPropertyName()&&value?.[this.numeroPropertyName()]){try{this.internalPhoneNumber=this.parsePhoneNumberForIndicatif(value[this.numeroPropertyName()],value[this.indicatifPropertyName()]),this.internalPhoneNumber.valid||(this.internalPhoneNumber=null)}catch(e){console.debug("PhoneNumberComponent error",e),this.internalPhoneNumber=null}this.formatIfNeeded()}else value?.[this.indicatifPropertyName()]||value?.[this.numeroPropertyName()]||(super.writeInnerValue(null),this.internalPhoneNumber=null)}setDisabledState(isDisabled){super.setDisabledState(isDisabled),isDisabled?(this.formGroup.get(this.indicatifPropertyName())?.disable(),this.formGroup.get(this.numeroPropertyName())?.disable()):(this.formGroup.get(this.indicatifPropertyName())?.enable(),this.formGroup.get(this.numeroPropertyName())?.enable())}selectFilter=(choiceList,typedString)=>choiceList?.filter((keyValue=>this.getValueOrKey(keyValue)?.toString().toLocaleLowerCase("fr-FR").split(") ")[1].startsWith(typedString.toLocaleLowerCase("fr-FR"))))??[];getValueOrKey(choiceTuple){return choiceTuple[1]??choiceTuple[0]}initializeListeIndicatifsTelephoniquesParPays(){return this.indicatifsTelephoniqueStoreService?(0,firstValueFrom._)(this.indicatifsTelephoniqueStoreService.read().pipe((0,tap.M)((indicatifsParPays=>{this.$indicatifsTelephoniquesParPaysTuple.set(indicatifsParPays.map((indicatifParPays=>[indicatifParPays.indicatif,indicatifParPays])))})),(0,catchError.W)((e=>(console.error("Erreur lors de la récupération de la liste des indicatifs auprès du backend ",e),this.initializeIndicatifsTelephoniquesWithLocalDefaultDatas()))))):this.initializeIndicatifsTelephoniquesWithLocalDefaultDatas()}initializeIndicatifsTelephoniquesWithLocalDefaultDatas(){return console.debug("initializePhoneNumberPrefixesWithLocalDefault"),(0,load_indicatifs_telephoniques.Z)().then((prefixes=>{this.$indicatifsTelephoniquesParPaysTuple()||this.$indicatifsTelephoniquesParPaysTuple.set(prefixes.map((p=>[p[0],new IndicatifTelephoniqueParPays(p[0],p[1],p[2])])))}))}whenOutterValueChange(outerValue){if(super.whenOutterValueChange(outerValue),outerValue){this.formGroup.patchValue(outerValue);let cc=outerValue?.[this.indicatifPropertyName()];cc=cc&&Number.parseInt(cc),this.updateExempleNumeroForCodeIso((0,index_esm.a0)(cc)??33)}else this.formGroup.reset()}onCountryCallingCodeChange($event){this.updateExempleNumeroForCodeIso($event.choice?.[1].codeIso?.toUpperCase())}updateExempleNumeroForCodeIso(codeIso="FR"){let exempleFromLib,typeExemple="mobile";PhoneTypeEnum.fixe===this.type()?typeExemple="fixed-line":PhoneTypeEnum.fax===this.type()&&(typeExemple="voip");try{exempleFromLib=(0,index_esm.rI)(codeIso,typeExemple)}catch(e){if("fixed-line"!==typeExemple)try{exempleFromLib=(0,index_esm.rI)(codeIso,"fixed-line")}catch(ee){console.warn(ee)}else console.warn(e)}exempleFromLib?.number?.national?this.$exempleNumero.set(`(exemple : ${exempleFromLib?.number?.national})`):this.$exempleNumero.set("")}buildReadOnlyValue(){return this.innerValue&&this.$isReadonlyState()&&this.indicatifPropertyName()&&this.numeroPropertyName()?"(+"+this.innerValue?.[this.indicatifPropertyName()]+") "+this.innerValue?.[this.numeroPropertyName()]:""}formatIfNeeded(){this.autoFormat()&&this.internalPhoneNumber&&this.$inputNumeroElementRef()&&setTimeout((()=>this.$inputNumeroElementRef().nativeElement.value=this.internalPhoneNumber.number?.national??""))}parsePhoneNumberForIndicatif(number,indicatif){return(0,index_esm.lq)(number,{regionCode:(0,index_esm.a0)(Number.parseInt(indicatif))})}onAfterSelectInit(){this.$selectId.set(this.$selectIndicatifElementRef()?.getLabelForTargetElement()?.id)}static ctorParameters=()=>[{type:core.Injector},{type:core.ElementRef}];static propDecorators={indicatifPropertyName:[{type:core.Input,args:[{isSignal:!0,alias:"indicatifPropertyName",required:!1,transform:void 0}]}],numeroPropertyName:[{type:core.Input,args:[{isSignal:!0,alias:"numeroPropertyName",required:!1,transform:void 0}]}],autoFormat:[{type:core.Input,args:[{isSignal:!0,alias:"autoFormat",required:!1,transform:void 0}]}],type:[{type:core.Input,args:[{isSignal:!0,alias:"type",required:!1,transform:void 0}]}],$inputNumeroElementRef:[{type:core.ViewChild,args:["inputNumero",{isSignal:!0}]}],$selectIndicatifElementRef:[{type:core.ViewChild,args:[select_component.w,{isSignal:!0}]}]}};PhoneNumberComponent=PhoneNumberComponent_1=(0,tslib_es6.Cg)([(0,core.Component)({selector:"zac-phone-number",imports:[select_component.w,fesm2022_forms.X1,common_module_Dx7dWex5.bT,on_init_directive.t],template:'@if ($indicatifsTelephoniquesParPaysTuple()) {\n  <ng-container [formGroup]="formGroup">\n    @if (!$isReadonlyState()) {\n      <div class="zac-phone-number--country-code">\n        <label\n          *ngIf="$selectId()"\n          for="{{$selectId()}}"\n          >Indicatif</label\n        >\n        <zac-select\n          #selectIndicatif\n          id="{{ id + \'-indicatif\' }}"\n          [choiceList]="$indicatifsTelephoniquesParPaysChoiceTuple()"\n          [formControlName]="indicatifPropertyName()"\n          [selectFilter]="selectFilter"\n          (choiceChange)="onCountryCallingCodeChange($event)"\n          (zacAfterViewInit)="onAfterSelectInit()"\n        >\n        </zac-select>\n      </div>\n      <div class="zac-phone-number--local-number">\n        <label for="{{ id + \'-telephone\' }}"\n          >Numéro {{ $exempleNumero() }}</label\n        >\n        <input\n          #inputNumero\n          id="{{ id + \'-telephone\' }}"\n          type="tel"\n          [formControlName]="numeroPropertyName()"\n        />\n      </div>\n    } @else {\n      <div>\n        <input\n          id="{{ id + \'-telephone\' }}"\n          type="text"\n          readonly\n          [value]="$readOnlyValue()"\n          [attr.aria-labelledby]="\'zac-label-\' + id"\n        />\n      </div>\n    }\n  </ng-container>\n}\n',encapsulation:core.ViewEncapsulation.None,changeDetection:core.ChangeDetectionStrategy.OnPush,host:{class:"zac-phone-number"},providers:[{provide:fesm2022_forms.cz,useExisting:(0,core.forwardRef)((()=>PhoneNumberComponent)),multi:!0}]})],PhoneNumberComponent);var form_field_component=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-field/form-field.component.ts"),errors_directive=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-error/errors/errors.directive.ts"),control_bar_component=__webpack_require__("./projects/zac-ng-lib/src/lib/button/control-bar/control-bar.component.ts"),CVA=__webpack_require__("./.storybook/common/CVA.md"),IntroStory=__webpack_require__("./.storybook/common/IntroStory.md"),mockdata=__webpack_require__("./projects/zac-ng-lib-testapp/src/app/mocks/mockdata.ts"),angular_in_memory_web_api=__webpack_require__("./node_modules/angular-in-memory-web-api/fesm2022/angular-in-memory-web-api.mjs");const phone_number_stories={title:"Formulaire/PhoneNumber",component:PhoneNumberComponent,tags:["docs"],decorators:[(0,dist.moduleMetadata)({imports:[fesm2022_forms.YN,PhoneNumberComponent,form_field_component.K,errors_directive.R,control_bar_component.W,module_z3bvLlVg.q1,angular_in_memory_web_api.DU.forRoot(mockdata.Z,{passThruUnknownUrl:!0,apiBase:"gcmext/wsrest"})],providers:[IndicatifsTelephoniquesStoreService]})],argTypes:{model:{control:"object"},readonly:{control:"boolean",description:"Mettre true sur <b>zac-form-field</b> pour forcer le champ en readonly."},disabled:{control:"boolean",description:"Désactive le composant"},type:{control:"radio",options:Object.values(PhoneTypeEnum)}}},template='\n<form zacErrors #myForm="ngForm" (ngSubmit)="onSubmit(myForm,model)">\n<zac-form-field label="Numéro de téléphone :" [readonly]="readonly">\n  <zac-phone-number\n    id="telephone"\n    name="telephone"\n    [indicatifPropertyName]="indicatifPropertyName"\n    [numeroPropertyName]="numeroPropertyName"\n    [disabled]="disabled"\n    [autoFormat]="autoFormat"\n    [type]="type"\n    [(ngModel)]="model.telephone"\n    required\n    >\n  </zac-phone-number>\n</zac-form-field>\n<zac-control-bar/>\n</form>\n<div style="margin-top: .5rem; font-size: .875rem; color: #666;">\n  <p><strong>Valeur liée dans le modèle :</strong></p>\n  <pre>{{ model | json }}</pre>\n</div>\n',ExempleNominal={name:"Exemple nominal",args:{model:{},indicatifPropertyName:"indicatif",numeroPropertyName:"numero",autoFormat:!0,disabled:!1,readonly:!1,type:void 0},parameters:{docs:{description:{story:`\n${CVA}\n${IntroStory}`},source:{code:template,language:"html"}}},render:args=>({props:{...args,onSubmit:(ngForm,model)=>{if(ngForm.valid){const telephone={...ngForm.form.value.telephone};console.log("submit ",telephone),setTimeout((()=>{model.telephone=telephone}))}}},moduleMetadata:{imports:[fesm2022_forms.YN,PhoneNumberComponent]},template})},__namedExportsOrder=["ExempleNominal"];ExempleNominal.parameters={...ExempleNominal.parameters,docs:{...ExempleNominal.parameters?.docs,source:{originalSource:"{\n  name: 'Exemple nominal',\n  args: {\n    model: {\n      //telephone: { indicatif: '33', numero: '0102030405' }\n    },\n    indicatifPropertyName: 'indicatif',\n    numeroPropertyName: 'numero',\n    autoFormat: true,\n    disabled: false,\n    readonly: false,\n    type: undefined\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\\n${cvaMd}\\n${introStoryMd}`\n      },\n      source: {\n        code: template,\n        language: 'html'\n      }\n    }\n  },\n  render: args => ({\n    props: {\n      ...args,\n      onSubmit: (ngForm: NgForm, model: {\n        telephone: {\n          indicatif?: string;\n          codeIso?: string;\n          nomPays?: string;\n          numero?: string;\n        };\n      }) => {\n        if (ngForm.valid) {\n          const telephone = {\n            ...ngForm.form.value.telephone\n          };\n          console.log('submit ', telephone);\n          setTimeout(() => {\n            model.telephone = telephone;\n          });\n        }\n      }\n    },\n    moduleMetadata: {\n      imports: [FormsModule, PhoneNumberComponent]\n    },\n    template: template\n  })\n}",...ExempleNominal.parameters?.docs?.source},description:{story:"Story présentant l'utilisation nominale du composant PhoneNumber.\r\n\nCe composant permet de saisir un numéro de téléphone international avec :\r\n- Un sélecteur de code pays (préfixe téléphonique)\r\n- Un champ de saisie pour le numéro\r\n\nLe composant gère automatiquement la liste des codes pays via libphonenumber-js.",...ExempleNominal.parameters?.docs?.description}}}},"./projects/zac-ng-lib/src/lib/form/select/select.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".combobox-input-container svg {\n  pointer-events: none;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./projects/zac-ng-lib/src/lib/form/select/select.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{w:()=>SelectComponent});var asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var select_componentngResource=__webpack_require__("./projects/zac-ng-lib/src/lib/form/select/select.component.scss?ngResource"),select_componentngResource_default=__webpack_require__.n(select_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),abstract_combobox_component=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/widget/abstract-combobox/abstract-combobox.component.ts"),theme_service=__webpack_require__("./projects/zac-ng-lib/src/lib/theme/theme.service.ts"),focus_tracker_service=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/service/focus-tracker/focus-tracker.service.ts"),common_module_Dx7dWex5=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module-Dx7dWex5.mjs"),choice_listbox_component=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/widget/choice-listbox/choice-listbox.component.ts"),pro_light_svg_icons=__webpack_require__("./node_modules/@fortawesome/pro-light-svg-icons/index.mjs"),component_icons_catalog=__webpack_require__("./projects/zac-ng-lib/src/lib/theme/component-icons-catalog.ts"),free_solid_svg_icons=__webpack_require__("./node_modules/@fortawesome/free-solid-svg-icons/index.mjs"),light_icon_component=__webpack_require__("./projects/zac-ng-lib/src/lib/theme/icon/light-icon.component.ts"),on_init_directive=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/widget/on-init.directive.ts"),dom_util=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/util/dom-util.ts"),css_context=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/css/css-context.ts");class SelectCssContext extends css_context.T{iconDown="--selectDown zac-icon:down";iconUp="--selectUp zac-icon:up";iconSelectInput="select-input-icon";comboboxListContainer="combobox-list-container";comboboxListContainerOpenedList="combobox-list-container-opened-list"}var NoneOptionEnum,configuration_zac=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/config/configuration-zac.ts");!function(NoneOptionEnum){NoneOptionEnum[NoneOptionEnum.without=0]="without",NoneOptionEnum[NoneOptionEnum.with=1]="with",NoneOptionEnum[NoneOptionEnum.ifNotRequired=2]="ifNotRequired"}(NoneOptionEnum||(NoneOptionEnum={}));class SelectConfig extends configuration_zac.oc{noneOption=NoneOptionEnum.without;configIntranet={noneOption:NoneOptionEnum.without};configExtranet={noneOption:NoneOptionEnum.without};constructor(){super()}}const SELECT_CONFIG_DEFAULT=new configuration_zac.MP(new SelectConfig).asThemeSensitiveRoot();var SelectComponent_1;const cssContext=new SelectCssContext;let SelectComponent=class SelectComponent extends abstract_combobox_component.D{static{SelectComponent_1=this}themeService;static ConfigToken=new core.InjectionToken("ZacselectConfigToken",{providedIn:"platform",factory:()=>SELECT_CONFIG_DEFAULT});static themeModuleHelper=new component_icons_catalog.P1(SelectComponent_1,[free_solid_svg_icons.Jt$,free_solid_svg_icons.w2A],[pro_light_svg_icons.Jt$,pro_light_svg_icons.w2A]);lastEntry;filteredList;filteredListCurrentIndex=-1;selectConfig=(0,core.inject)(SelectComponent_1.ConfigToken);cssContext=cssContext;constructor(injector,elementRef,renderer,cdr,themeService,focusTracker){super(injector,elementRef,renderer,cdr,focusTracker),this.themeService=themeService,(0,core.inject)(theme_service.F).feedIconLibraryForComponent(SelectComponent_1.themeModuleHelper)}noneOption=(0,core.input)(void 0);get nameIconDown(){return"selectDown"}get nameIconUp(){return"selectUp"}ngOnInit(){super.ngOnInit(),this.cssContext.initializeComponent(this),this.renderer.addClass(this.elementRef.nativeElement,"select")}ngAfterContentInit(){this.configureNoneOption(this.selectConfig.noneOption)}ngOnChanges(changes){(changes.noneOption||changes.choiceList)&&this.configureNoneOption(this.selectConfig.noneOption)}onFocus(element){"INPUT"===element.tagName&&this.inputElement?.setSelectionRange(0,0)}onKeydown(element,event){var _this=this;return(0,asyncToGenerator.A)((function*(){"INPUT"===element.tagName&&(yield _this.onInputKeydownEvent(event))}))()}onClick(element){switch(element.tagName){case"INPUT":case"svg":case"path":this.onToggle()}}onToggle(){this.choiceList&&!this.isListboxOpened()?this.openListBoxWith(this.choiceList).then():this.closeListbox()}onActiveElementChange(optionElement){this.activeDescendantId=optionElement?.id,this.changeInputElementValueFromOptionElementFocused(optionElement)}activeDescendantId;determineInnerValue(){var _this2=this;return(0,asyncToGenerator.A)((function*(){_this2.setChoice([_this2.selectedOptionKey,_this2.selectedOptionValue??""]),_this2.lastEntry=void 0,_this2.filteredListCurrentIndex=0,_this2.closeListbox()}))()}selectFilter=(choiceList,typedString)=>this.choiceList?.filter((keyValue=>this.getValueOrKey(keyValue)?.toString().toLocaleLowerCase("fr-FR").startsWith(typedString.toLocaleLowerCase("fr-FR"))))??[];onInputKeydownEvent(event){var _this3=this;return(0,asyncToGenerator.A)((function*(){if(_this3.inputElement&&_this3.choiceList)switch(event.key){case"ArrowDown":_this3.isListboxOpened()||(_this3.manageSelectEntry(event.key),(0,dom_util.jo)(event));break;case"Spacebar":case" ":case"Enter":(0,dom_util.jo)(event),_this3.openListBoxWith(_this3.choiceList).then();break;case"Escape":_this3.closeListbox();break;default:_this3.manageSelectEntry(event.key)&&(0,dom_util.jo)(event)}}))()}disableComponent(isDisabled){var _this4=this;return(0,asyncToGenerator.A)((function*(){yield _this4.timeToLetControlDisplay,isDisabled?_this4.inputElement?.setAttribute("disabled","true"):_this4.inputElement?.removeAttribute("disabled")}))()}manageSelectEntry(key){let managed=!1;return this.filteredList&&this.isSameEntry(key)||this.startNewFilteredList(key),null!=key&&this.filteredList&&this.inputElement&&("ArrowDown"===key?(this.incrementFilteredListCurrentIndex(),managed=!0):"ArrowUp"===key?(this.decrementFilteredListCurrentIndex(),managed=!0):"Tab"!==key&&(this.incrementFilteredListCurrentIndex(),managed=!0),this.isFilteredListCurrentIndexCorrect()&&(this.inputElement.value=this.getValueOrKey(this.filteredList[this.filteredListCurrentIndex])?.toString()??"",this.selectedOptionKey=this.filteredList[this.filteredListCurrentIndex][0],this.selectedOptionValue=this.filteredList[this.filteredListCurrentIndex][1])),this.lastEntry=key,managed}isFilteredListCurrentIndexCorrect(){return this.filteredListCurrentIndex>-1&&this.filteredListCurrentIndex<(this.filteredList?.length??0)}startNewFilteredList(key){this.filteredList=this.buildFilteredList(key),this.choiceList&&this.navigationKey(key)?this.filteredListCurrentIndex=this.findIndexOfCurrentInnerValueInList(this.choiceList):this.filteredListCurrentIndex=-1}navigationKey(key){return"ArrowUp"===key||"ArrowDown"===key}decrementFilteredListCurrentIndex(){this.filteredListCurrentIndex>0?this.filteredListCurrentIndex=this.filteredListCurrentIndex-1:this.filteredListCurrentIndex=this.filteredList?.length??0}incrementFilteredListCurrentIndex(){this.filteredListCurrentIndex+1<(this.filteredList?.length??0)?this.filteredListCurrentIndex=this.filteredListCurrentIndex+1:this.filteredListCurrentIndex=0}isSameEntry(key){return this.lastEntry===key||this.lastEntry&&this.navigationKey(key)&&this.navigationKey(this.lastEntry)}buildFilteredList(key){return this.navigationKey(key)?this.choiceList:this.selectFilter&&this.choiceList?this.selectFilter(this.choiceList,key):[]}changeInputElementValueFromOptionElementFocused(optionElement){if(optionElement&&this.inputElement){const i=optionElement.getAttribute("aria-posinset"),v=(i&&this.visibleList&&this.visibleList[Number.parseInt(i)])??void 0;v&&(this.inputElement.value=v[1]?`${v[1]}`:"")}}addNoneOption(){const choiceList=this.getChoiceList();choiceList&&!choiceList?.find((choice=>!choice[0]))&&choiceList.splice(0,0,[void 0])}removeNoneOption(){const choiceList=this.getChoiceList();if(choiceList){const index=choiceList.findIndex((choice=>!choice[0]));-1!==index&&choiceList.splice(index,1)}}configureNoneOption(noneOption){const thisNoneOption=this.noneOption();if(null!=thisNoneOption)thisNoneOption?this.addNoneOption():this.removeNoneOption();else switch(noneOption){case NoneOptionEnum.with:this.addNoneOption();break;case NoneOptionEnum.ifNotRequired:setTimeout((()=>{this.isRequired?.()||this.addNoneOption()}),100)}}static ctorParameters=()=>[{type:core.Injector},{type:core.ElementRef},{type:core.Renderer2},{type:core.ChangeDetectorRef},{type:theme_service.F},{type:focus_tracker_service.g}];static propDecorators={noneOption:[{type:core.Input,args:[{isSignal:!0,alias:"noneOption",required:!1,transform:void 0}]}],onFocus:[{type:core.HostListener,args:["focusin",["$event.target","$event"]]}],onKeydown:[{type:core.HostListener,args:["keydown",["$event.target","$event"]]}],onClick:[{type:core.HostListener,args:["click",["$event.target","$event"]]}],selectFilter:[{type:core.Input}]}};SelectComponent=SelectComponent_1=(0,tslib_es6.Cg)([(0,core.Component)({selector:"zac-select",template:'<ng-container *ngIf="!$isReadonlyState(); else caseReadonly">\n  <div class="combobox-input-container">\n    <input\n      role="combobox"\n      #input\n      [attr.id]="\'zac-select-\' + id"\n      readonly\n      combobox="off"\n      [attr.aria-controls]="listboxId"\n      [attr.aria-expanded]="isListboxOpened()"\n      [attr.aria-activedescendant]="activeDescendantId"\n      class="internal_readonly"\n    />\n\n    <span\n      class="{{ cssContext.iconSelectInput }}"\n      aria-hidden="true"\n      (click)="onToggle()"\n    >\n      <zac-light-icon\n        *ngIf="isListboxOpened(); else iconUp"\n        [iconName]="nameIconUp"\n        class="{{ cssContext.iconUp }}"\n      ></zac-light-icon>\n      <ng-template #iconUp\n        ><zac-light-icon\n          [iconName]="nameIconDown"\n          class="{{ cssContext.iconDown }}"\n        ></zac-light-icon\n      ></ng-template>\n    </span>\n  </div>\n  <div #list_container class="{{ cssContext.comboboxListContainer }}">\n    <p\n      *ngIf="canOpenList()"\n      role="alert"\n      class="{{ cssContext.comboboxListContainerOpenedList }}"\n      aria-label="Flèche du bas pour sélectionner un choix possible a partir de votre saisie parmi la liste ci-dessous"\n    >\n      <span aria-hidden="true"></span>\n    </p>\n\n    <zac-choice-listbox\n      #choiceListboxComponent\n      [triggerElement]="input"\n      [listboxId]="listboxId"\n      [canOpenList]="canOpenList()"\n      [choiceList]="visibleList"\n      [contentRef]="contentRef"\n      [listSize]="listSize"\n      [bottomRef]="bottomRef"\n      [selectedValue]="innerValue"\n      (selectedChoice)="onListboxChoice($event)"\n      (activeElement)="onActiveElementChange($event)"\n    >\n    </zac-choice-listbox>\n  </div>\n</ng-container>\n<ng-template #caseReadonly>\n  <ng-container (zacAfterContentInit)="findLibelleForValue(innerValue)">\n    <input readonly [value]="$libelleForValue()" />\n  </ng-container>\n</ng-template>\n',encapsulation:core.ViewEncapsulation.None,imports:[common_module_Dx7dWex5.bT,choice_listbox_component.C,light_icon_component.N,on_init_directive.t],providers:[{provide:fesm2022_forms.kq,useExisting:(0,core.forwardRef)((()=>SelectComponent)),multi:!0}],host:{class:"zac-select"},changeDetection:core.ChangeDetectionStrategy.OnPush,styles:[select_componentngResource_default()]})],SelectComponent)}}]);