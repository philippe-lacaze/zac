(self.webpackChunkzac_ng_lib=self.webpackChunkzac_ng_lib||[]).push([[549],{"./projects/zac-ng-lib/src/lib/form/select/select.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".combobox-input-container svg {\n  pointer-events: none;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./projects/zac-ng-lib/src/lib/form/select/select.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{w:()=>SelectComponent});var asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var select_componentngResource=__webpack_require__("./projects/zac-ng-lib/src/lib/form/select/select.component.scss?ngResource"),select_componentngResource_default=__webpack_require__.n(select_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),abstract_combobox_component=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/widget/abstract-combobox/abstract-combobox.component.ts"),theme_service=__webpack_require__("./projects/zac-ng-lib/src/lib/theme/theme.service.ts"),focus_tracker_service=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/service/focus-tracker/focus-tracker.service.ts"),common_module_Dx7dWex5=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module-Dx7dWex5.mjs"),choice_listbox_component=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/widget/choice-listbox/choice-listbox.component.ts"),pro_light_svg_icons=__webpack_require__("./node_modules/@fortawesome/pro-light-svg-icons/index.mjs"),component_icons_catalog=__webpack_require__("./projects/zac-ng-lib/src/lib/theme/component-icons-catalog.ts"),free_solid_svg_icons=__webpack_require__("./node_modules/@fortawesome/free-solid-svg-icons/index.mjs"),light_icon_component=__webpack_require__("./projects/zac-ng-lib/src/lib/theme/icon/light-icon.component.ts"),on_init_directive=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/widget/on-init.directive.ts"),dom_util=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/util/dom-util.ts"),css_context=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/css/css-context.ts");class SelectCssContext extends css_context.T{iconDown="--selectDown zac-icon:down";iconUp="--selectUp zac-icon:up";iconSelectInput="select-input-icon";comboboxListContainer="combobox-list-container";comboboxListContainerOpenedList="combobox-list-container-opened-list"}var NoneOptionEnum,configuration_zac=__webpack_require__("./projects/zac-ng-lib/src/lib/shared/config/configuration-zac.ts");!function(NoneOptionEnum){NoneOptionEnum[NoneOptionEnum.without=0]="without",NoneOptionEnum[NoneOptionEnum.with=1]="with",NoneOptionEnum[NoneOptionEnum.ifNotRequired=2]="ifNotRequired"}(NoneOptionEnum||(NoneOptionEnum={}));class SelectConfig extends configuration_zac.oc{noneOption=NoneOptionEnum.without;configIntranet={noneOption:NoneOptionEnum.without};configExtranet={noneOption:NoneOptionEnum.without};constructor(){super()}}const SELECT_CONFIG_DEFAULT=new configuration_zac.MP(new SelectConfig).asThemeSensitiveRoot();var SelectComponent_1;const cssContext=new SelectCssContext;let SelectComponent=class SelectComponent extends abstract_combobox_component.D{static{SelectComponent_1=this}themeService;static ConfigToken=new core.InjectionToken("ZacselectConfigToken",{providedIn:"platform",factory:()=>SELECT_CONFIG_DEFAULT});static themeModuleHelper=new component_icons_catalog.P1(SelectComponent_1,[free_solid_svg_icons.Jt$,free_solid_svg_icons.w2A],[pro_light_svg_icons.Jt$,pro_light_svg_icons.w2A]);lastEntry;filteredList;filteredListCurrentIndex=-1;selectConfig=(0,core.inject)(SelectComponent_1.ConfigToken);cssContext=cssContext;constructor(injector,elementRef,renderer,cdr,themeService,focusTracker){super(injector,elementRef,renderer,cdr,focusTracker),this.themeService=themeService,(0,core.inject)(theme_service.F).feedIconLibraryForComponent(SelectComponent_1.themeModuleHelper)}noneOption=(0,core.input)(void 0);get nameIconDown(){return"selectDown"}get nameIconUp(){return"selectUp"}ngOnInit(){super.ngOnInit(),this.cssContext.initializeComponent(this),this.renderer.addClass(this.elementRef.nativeElement,"select")}ngAfterContentInit(){this.configureNoneOption(this.selectConfig.noneOption)}ngOnChanges(changes){(changes.noneOption||changes.choiceList)&&this.configureNoneOption(this.selectConfig.noneOption)}onFocus(element){"INPUT"===element.tagName&&this.inputElement?.setSelectionRange(0,0)}onKeydown(element,event){var _this=this;return(0,asyncToGenerator.A)((function*(){"INPUT"===element.tagName&&(yield _this.onInputKeydownEvent(event))}))()}onClick(element){switch(element.tagName){case"INPUT":case"svg":case"path":this.onToggle()}}onToggle(){this.choiceList&&!this.isListboxOpened()?this.openListBoxWith(this.choiceList).then():this.closeListbox()}onActiveElementChange(optionElement){this.activeDescendantId=optionElement?.id,this.changeInputElementValueFromOptionElementFocused(optionElement)}activeDescendantId;determineInnerValue(){var _this2=this;return(0,asyncToGenerator.A)((function*(){_this2.setChoice([_this2.selectedOptionKey,_this2.selectedOptionValue??""]),_this2.lastEntry=void 0,_this2.filteredListCurrentIndex=0,_this2.closeListbox()}))()}selectFilter=(choiceList,typedString)=>this.choiceList?.filter((keyValue=>this.getValueOrKey(keyValue)?.toString().toLocaleLowerCase("fr-FR").startsWith(typedString.toLocaleLowerCase("fr-FR"))))??[];onInputKeydownEvent(event){var _this3=this;return(0,asyncToGenerator.A)((function*(){if(_this3.inputElement&&_this3.choiceList)switch(event.key){case"ArrowDown":_this3.isListboxOpened()||(_this3.manageSelectEntry(event.key),(0,dom_util.jo)(event));break;case"Spacebar":case" ":case"Enter":(0,dom_util.jo)(event),_this3.openListBoxWith(_this3.choiceList).then();break;case"Escape":_this3.closeListbox();break;default:_this3.manageSelectEntry(event.key)&&(0,dom_util.jo)(event)}}))()}disableComponent(isDisabled){var _this4=this;return(0,asyncToGenerator.A)((function*(){yield _this4.timeToLetControlDisplay,isDisabled?_this4.inputElement?.setAttribute("disabled","true"):_this4.inputElement?.removeAttribute("disabled")}))()}manageSelectEntry(key){let managed=!1;return this.filteredList&&this.isSameEntry(key)||this.startNewFilteredList(key),null!=key&&this.filteredList&&this.inputElement&&("ArrowDown"===key?(this.incrementFilteredListCurrentIndex(),managed=!0):"ArrowUp"===key?(this.decrementFilteredListCurrentIndex(),managed=!0):"Tab"!==key&&(this.incrementFilteredListCurrentIndex(),managed=!0),this.isFilteredListCurrentIndexCorrect()&&(this.inputElement.value=this.getValueOrKey(this.filteredList[this.filteredListCurrentIndex])?.toString()??"",this.selectedOptionKey=this.filteredList[this.filteredListCurrentIndex][0],this.selectedOptionValue=this.filteredList[this.filteredListCurrentIndex][1])),this.lastEntry=key,managed}isFilteredListCurrentIndexCorrect(){return this.filteredListCurrentIndex>-1&&this.filteredListCurrentIndex<(this.filteredList?.length??0)}startNewFilteredList(key){this.filteredList=this.buildFilteredList(key),this.choiceList&&this.navigationKey(key)?this.filteredListCurrentIndex=this.findIndexOfCurrentInnerValueInList(this.choiceList):this.filteredListCurrentIndex=-1}navigationKey(key){return"ArrowUp"===key||"ArrowDown"===key}decrementFilteredListCurrentIndex(){this.filteredListCurrentIndex>0?this.filteredListCurrentIndex=this.filteredListCurrentIndex-1:this.filteredListCurrentIndex=this.filteredList?.length??0}incrementFilteredListCurrentIndex(){this.filteredListCurrentIndex+1<(this.filteredList?.length??0)?this.filteredListCurrentIndex=this.filteredListCurrentIndex+1:this.filteredListCurrentIndex=0}isSameEntry(key){return this.lastEntry===key||this.lastEntry&&this.navigationKey(key)&&this.navigationKey(this.lastEntry)}buildFilteredList(key){return this.navigationKey(key)?this.choiceList:this.selectFilter&&this.choiceList?this.selectFilter(this.choiceList,key):[]}changeInputElementValueFromOptionElementFocused(optionElement){if(optionElement&&this.inputElement){const i=optionElement.getAttribute("aria-posinset"),v=(i&&this.visibleList&&this.visibleList[Number.parseInt(i)])??void 0;v&&(this.inputElement.value=v[1]?`${v[1]}`:"")}}addNoneOption(){const choiceList=this.getChoiceList();choiceList&&!choiceList?.find((choice=>!choice[0]))&&choiceList.splice(0,0,[void 0])}removeNoneOption(){const choiceList=this.getChoiceList();if(choiceList){const index=choiceList.findIndex((choice=>!choice[0]));-1!==index&&choiceList.splice(index,1)}}configureNoneOption(noneOption){const thisNoneOption=this.noneOption();if(null!=thisNoneOption)thisNoneOption?this.addNoneOption():this.removeNoneOption();else switch(noneOption){case NoneOptionEnum.with:this.addNoneOption();break;case NoneOptionEnum.ifNotRequired:setTimeout((()=>{this.isRequired?.()||this.addNoneOption()}),100)}}static ctorParameters=()=>[{type:core.Injector},{type:core.ElementRef},{type:core.Renderer2},{type:core.ChangeDetectorRef},{type:theme_service.F},{type:focus_tracker_service.g}];static propDecorators={noneOption:[{type:core.Input,args:[{isSignal:!0,alias:"noneOption",required:!1,transform:void 0}]}],onFocus:[{type:core.HostListener,args:["focusin",["$event.target","$event"]]}],onKeydown:[{type:core.HostListener,args:["keydown",["$event.target","$event"]]}],onClick:[{type:core.HostListener,args:["click",["$event.target","$event"]]}],selectFilter:[{type:core.Input}]}};SelectComponent=SelectComponent_1=(0,tslib_es6.Cg)([(0,core.Component)({selector:"zac-select",template:'<ng-container *ngIf="!$isReadonlyState(); else caseReadonly">\n  <div class="combobox-input-container">\n    <input\n      role="combobox"\n      #input\n      [attr.id]="\'zac-select-\' + id"\n      readonly\n      combobox="off"\n      [attr.aria-controls]="listboxId"\n      [attr.aria-expanded]="isListboxOpened()"\n      [attr.aria-activedescendant]="activeDescendantId"\n      class="internal_readonly"\n    />\n\n    <span\n      class="{{ cssContext.iconSelectInput }}"\n      aria-hidden="true"\n      (click)="onToggle()"\n    >\n      <zac-light-icon\n        *ngIf="isListboxOpened(); else iconUp"\n        [iconName]="nameIconUp"\n        class="{{ cssContext.iconUp }}"\n      ></zac-light-icon>\n      <ng-template #iconUp\n        ><zac-light-icon\n          [iconName]="nameIconDown"\n          class="{{ cssContext.iconDown }}"\n        ></zac-light-icon\n      ></ng-template>\n    </span>\n  </div>\n  <div #list_container class="{{ cssContext.comboboxListContainer }}">\n    <p\n      *ngIf="canOpenList()"\n      role="alert"\n      class="{{ cssContext.comboboxListContainerOpenedList }}"\n      aria-label="Flèche du bas pour sélectionner un choix possible a partir de votre saisie parmi la liste ci-dessous"\n    >\n      <span aria-hidden="true"></span>\n    </p>\n\n    <zac-choice-listbox\n      #choiceListboxComponent\n      [triggerElement]="input"\n      [listboxId]="listboxId"\n      [canOpenList]="canOpenList()"\n      [choiceList]="visibleList"\n      [contentRef]="contentRef"\n      [listSize]="listSize"\n      [bottomRef]="bottomRef"\n      [selectedValue]="innerValue"\n      (selectedChoice)="onListboxChoice($event)"\n      (activeElement)="onActiveElementChange($event)"\n    >\n    </zac-choice-listbox>\n  </div>\n</ng-container>\n<ng-template #caseReadonly>\n  <ng-container (zacAfterContentInit)="findLibelleForValue(innerValue)">\n    <input readonly [value]="$libelleForValue()" />\n  </ng-container>\n</ng-template>\n',encapsulation:core.ViewEncapsulation.None,imports:[common_module_Dx7dWex5.bT,choice_listbox_component.C,light_icon_component.N,on_init_directive.t],providers:[{provide:fesm2022_forms.kq,useExisting:(0,core.forwardRef)((()=>SelectComponent)),multi:!0}],host:{class:"zac-select"},changeDetection:core.ChangeDetectionStrategy.OnPush,styles:[select_componentngResource_default()]})],SelectComponent)},"./projects/zac-ng-lib/src/lib/form/select/select.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ExempleNominal:()=>ExempleNominal,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _storybook_angular__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),_angular_forms__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),_select_component__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./projects/zac-ng-lib/src/lib/form/select/select.component.ts"),_form_field_form_field_component__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-field/form-field.component.ts"),_form_error_errors_errors_directive__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./projects/zac-ng-lib/src/lib/form/form-error/errors/errors.directive.ts"),_button_control_bar_control_bar_component__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./projects/zac-ng-lib/src/lib/button/control-bar/control-bar.component.ts"),_storybook_common_CVA_md__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./.storybook/common/CVA.md"),_storybook_common_IntroStory_md__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./.storybook/common/IntroStory.md");const __WEBPACK_DEFAULT_EXPORT__={title:"Formulaire/Select",component:_select_component__WEBPACK_IMPORTED_MODULE_3__.w,tags:["docs"],decorators:[(0,_storybook_angular__WEBPACK_IMPORTED_MODULE_0__.moduleMetadata)({imports:[_angular_forms__WEBPACK_IMPORTED_MODULE_4__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_4__.X1,_select_component__WEBPACK_IMPORTED_MODULE_3__.w,_form_field_form_field_component__WEBPACK_IMPORTED_MODULE_5__.K,_form_error_errors_errors_directive__WEBPACK_IMPORTED_MODULE_6__.R,_button_control_bar_control_bar_component__WEBPACK_IMPORTED_MODULE_7__.W]})],argTypes:{model:{control:"object",table:{disable:!0}},$choiceListSource:{table:{disable:!0}},$fromPropertyChoiceListSource:{table:{disable:!0}},selectFilter:{table:{disable:!0}},readonly:{control:"boolean",description:"Mettre true sur <b>zac-form-field</b> pour forcer le champ en readonly."}}},template='\n<form zacErrors>\n<zac-form-field label="Choisissez une option :" [readonly]="readonly">\n  <zac-select\n    id="choix"\n    name="choix"\n    [listSize]="listSize"\n    [choiceList]="choiceList"\n    [disabled]="disabled"\n    [noneOption]="noneOption"\n    [(ngModel)]="model.choix"\n    required\n    >\n  </zac-select>\n</zac-form-field>\n<zac-control-bar/>\n</form>\n<p style="margin-top: .5rem; font-size: .875rem; color: #666;">Valeur sélectionnée : {{ model.choix }}</p>\n',ExempleNominal={name:"Exemple nominal",args:{model:{},choiceList:[["A","Option A"],["B","Option B"],["C","Option C"],["D","Option D"],["E","Option E"],["F","Option F"]],listSize:5,disabled:!1,readonly:!1,noneOption:!1},parameters:{docs:{description:{story:`\n${_storybook_common_CVA_md__WEBPACK_IMPORTED_MODULE_1__}\n${_storybook_common_IntroStory_md__WEBPACK_IMPORTED_MODULE_2__}`},source:{code:template,language:"html"}}},render:args=>({props:{...args},moduleMetadata:{imports:[_angular_forms__WEBPACK_IMPORTED_MODULE_4__.YN,_select_component__WEBPACK_IMPORTED_MODULE_3__.w]},template})},__namedExportsOrder=["ExempleNominal"];ExempleNominal.parameters={...ExempleNominal.parameters,docs:{...ExempleNominal.parameters?.docs,source:{originalSource:"{\n  name: 'Exemple nominal',\n  args: {\n    model: {},\n    choiceList: [['A', 'Option A'], ['B', 'Option B'], ['C', 'Option C'], ['D', 'Option D'], ['E', 'Option E'], ['F', 'Option F']],\n    listSize: 5,\n    disabled: false,\n    readonly: false,\n    noneOption: false\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\\n${cvaMd}\\n${introStoryMd}`\n      },\n      source: {\n        code: template,\n        language: 'html'\n      }\n    }\n  },\n  render: args => ({\n    props: {\n      ...args\n    },\n    moduleMetadata: {\n      imports: [FormsModule, SelectComponent]\n    },\n    template: template\n  })\n}",...ExempleNominal.parameters?.docs?.source}}}}}]);